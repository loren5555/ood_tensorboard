#!/usr/bin/env bash
set -euo pipefail

echo "TIMING - Starting main script at: $(date)"

# 在前台启动前，先写出连接信息（供 OOD 连接视图使用）
host="$(hostname -f)"
: "${port:?port not set by before.sh.erb}"
pw="${password:-}"

cat > connection.yml <<EOF
---
host: ${host}
port: ${port}
password: ${pw}
EOF

echo "TIMING - Launching Jupyter (foreground) at: $(date)"

exec "tensorboard" --logdir="<%= context.logdir %>" --port=${port} --bind_all
